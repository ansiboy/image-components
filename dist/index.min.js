/*!
 * 
 *  maishu-image-components v1.2.2
 * 
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("maishu-ui-toolkit"),require("react"),require("maishu-wuzhui-helper"),require("react-dom"),require("maishu-chitu")):"function"==typeof define&&define.amd?define(["maishu-ui-toolkit","react","maishu-wuzhui-helper","react-dom","maishu-chitu"],t):"object"==typeof exports?exports["image-components"]=t(require("maishu-ui-toolkit"),require("react"),require("maishu-wuzhui-helper"),require("react-dom"),require("maishu-chitu")):e["image-components"]=t(e["maishu-ui-toolkit"],e.react,e["maishu-wuzhui-helper"],e["react-dom"],e["maishu-chitu"])}(window,(function(e,t,n,r,i){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=12)}([function(e,t,n){"use strict";var r,i=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),o=[];function s(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].identifier===e){t=n;break}return t}function l(e,t){for(var n={},r=[],i=0;i<e.length;i++){var a=e[i],l=t.base?a[0]+t.base:a[0],u=n[l]||0,c="".concat(l," ").concat(u);n[l]=u+1;var d=s(c),m={css:a[1],media:a[2],sourceMap:a[3]};-1!==d?(o[d].references++,o[d].updater(m)):o.push({identifier:c,updater:g(m,t),references:1}),r.push(c)}return r}function u(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var i=n.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var o=a(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,d=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function m(e,t,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=d(t,i);else{var a=document.createTextNode(i),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}function h(e,t,n){var r=n.css,i=n.media,a=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var p=null,f=0;function g(e,t){var n,r,i;if(t.singleton){var a=f++;n=p||(p=u(t)),r=m.bind(null,n,a,!1),i=m.bind(null,n,a,!0)}else n=u(t),r=h.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=i());var n=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var i=s(n[r]);o[i].references--}for(var a=l(e,t),u=0;u<n.length;u++){var c=s(n[u]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}n=a}}}},function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.exports=function(e){var t=r(e,4),n=t[1],i=t[3];if("function"==typeof btoa){var a=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),s="/*# ".concat(o," */"),l=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(e," */")}));return[n].concat(l).concat([s]).join("\n")}return[n].join("\n")}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(i[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);r&&i[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setLanguage=t.getStrings=void 0;let r={chinese:{selectImage:"选择图片",selectMax:"最多可选",cancel:"取消",confirm:"确定",deleteImageConfirm:"确定删除该图片吗？",imageUpload:"图片上传",noImageText:"暂无图片"},english:{selectImage:"Select Image",selectMax:"Select Max",cancel:"Cancel",confirm:"Confirm",deleteImageConfirm:"Are you sure delete the image?",imageUpload:"Image Upload",noImageText:"NO IMAGE"}};t.getStrings=function(e){return e=e||a(),r[e]};let i="chinese";function a(){return i}t.setLanguage=function(e){i=e}},function(e,n){e.exports=t},function(e,t,n){"use strict";var r=n(1),i=n.n(r),a=n(2),o=n.n(a)()(i.a);o.push([e.i,".image-thumber {\n  width: 120px;\n  position: relative;\n}\n.image-thumber .item {\n  border: solid 1px #ccc;\n}\n.image-thumber .item .bottom {\n  display: block;\n  overflow: hidden;\n  white-space: nowrap;\n  -webkit-text-overflow: ellipsis;\n  -ms-text-overflow: ellipsis;\n  -o-text-overflow: ellipsis;\n  text-overflow: ellipsis;\n  position: absolute;\n  bottom: 0;\n  padding: 4px 8px 0px 8px;\n  font-size: 12px;\n  text-align: center;\n  background-color: rgba(0, 0, 0, 0.55);\n  color: white;\n  width: calc(100% - 2px);\n  height: 24px;\n}\n.image-thumber .item .bottom button {\n  color: white;\n}\n.image-thumber .item .top {\n  position: absolute;\n  height: 18px;\n  margin-top: -18px;\n  padding-top: 18px;\n  color: white;\n  font-size: 12px;\n  font-weight: bold;\n  text-align: right;\n  width: calc(100% - 2px);\n}\n.image-thumber .item.selected {\n  border-color: blue;\n}\n.image-thumber .item.selected .triangle {\n  position: relative;\n  top: 19px;\n  left: calc(100% - 18px);\n  width: 20px;\n  height: 20px;\n  margin-top: -40px;\n  background: transparent;\n  border-top: 20px solid transparent;\n  border-bottom: 20px solid blue;\n  border-left: 20px solid transparent;\n  border-right: 20px solid transparent;\n  transform: rotate(45deg);\n}\n.image-thumber .item.selected:hover .remove {\n  display: none;\n}\n.image-thumber .item .remove {\n  display: none;\n}\n.image-thumber .item:hover .remove {\n  position: relative;\n  left: calc(100% - 20px);\n  top: 20px;\n  width: 20px;\n  height: 20px;\n  border-radius: 10px;\n  margin-top: -20px;\n  display: block;\n  background-color: rgba(0, 0, 0, 0.55);\n}\n.image-thumber .item:hover .remove i {\n  color: white;\n}\n.image-thumber .item .disabled {\n  position: absolute;\n  width: calc(100% - 2px);\n  height: calc(100% - 2px);\n  background-color: gray;\n  top: 0px;\n  opacity: 0.3;\n}\n","",{version:3,sources:["webpack://./content/image-thumber.less"],names:[],mappings:"AAAA;EACE,YAAY;EACZ,kBAAkB;AACpB;AACA;EACE,sBAAsB;AACxB;AACA;EACE,cAAc;EACd,gBAAgB;EAChB,mBAAmB;EACnB,+BAA+B;EAC/B,2BAA2B;EAC3B,0BAA0B;EAC1B,uBAAuB;EACvB,kBAAkB;EAClB,SAAS;EACT,wBAAwB;EACxB,eAAe;EACf,kBAAkB;EAClB,qCAAqC;EACrC,YAAY;EACZ,uBAAuB;EACvB,YAAY;AACd;AACA;EACE,YAAY;AACd;AACA;EACE,kBAAkB;EAClB,YAAY;EACZ,iBAAiB;EACjB,iBAAiB;EACjB,YAAY;EACZ,eAAe;EACf,iBAAiB;EACjB,iBAAiB;EACjB,uBAAuB;AACzB;AACA;EACE,kBAAkB;AACpB;AACA;EACE,kBAAkB;EAClB,SAAS;EACT,uBAAuB;EACvB,WAAW;EACX,YAAY;EACZ,iBAAiB;EACjB,uBAAuB;EACvB,kCAAkC;EAClC,8BAA8B;EAC9B,mCAAmC;EACnC,oCAAoC;EACpC,wBAAwB;AAC1B;AACA;EACE,aAAa;AACf;AACA;EACE,aAAa;AACf;AACA;EACE,kBAAkB;EAClB,uBAAuB;EACvB,SAAS;EACT,WAAW;EACX,YAAY;EACZ,mBAAmB;EACnB,iBAAiB;EACjB,cAAc;EACd,qCAAqC;AACvC;AACA;EACE,YAAY;AACd;AACA;EACE,kBAAkB;EAClB,uBAAuB;EACvB,wBAAwB;EACxB,sBAAsB;EACtB,QAAQ;EACR,YAAY;AACd",sourcesContent:[".image-thumber {\n  width: 120px;\n  position: relative;\n}\n.image-thumber .item {\n  border: solid 1px #ccc;\n}\n.image-thumber .item .bottom {\n  display: block;\n  overflow: hidden;\n  white-space: nowrap;\n  -webkit-text-overflow: ellipsis;\n  -ms-text-overflow: ellipsis;\n  -o-text-overflow: ellipsis;\n  text-overflow: ellipsis;\n  position: absolute;\n  bottom: 0;\n  padding: 4px 8px 0px 8px;\n  font-size: 12px;\n  text-align: center;\n  background-color: rgba(0, 0, 0, 0.55);\n  color: white;\n  width: calc(100% - 2px);\n  height: 24px;\n}\n.image-thumber .item .bottom button {\n  color: white;\n}\n.image-thumber .item .top {\n  position: absolute;\n  height: 18px;\n  margin-top: -18px;\n  padding-top: 18px;\n  color: white;\n  font-size: 12px;\n  font-weight: bold;\n  text-align: right;\n  width: calc(100% - 2px);\n}\n.image-thumber .item.selected {\n  border-color: blue;\n}\n.image-thumber .item.selected .triangle {\n  position: relative;\n  top: 19px;\n  left: calc(100% - 18px);\n  width: 20px;\n  height: 20px;\n  margin-top: -40px;\n  background: transparent;\n  border-top: 20px solid transparent;\n  border-bottom: 20px solid blue;\n  border-left: 20px solid transparent;\n  border-right: 20px solid transparent;\n  transform: rotate(45deg);\n}\n.image-thumber .item.selected:hover .remove {\n  display: none;\n}\n.image-thumber .item .remove {\n  display: none;\n}\n.image-thumber .item:hover .remove {\n  position: relative;\n  left: calc(100% - 20px);\n  top: 20px;\n  width: 20px;\n  height: 20px;\n  border-radius: 10px;\n  margin-top: -20px;\n  display: block;\n  background-color: rgba(0, 0, 0, 0.55);\n}\n.image-thumber .item:hover .remove i {\n  color: white;\n}\n.image-thumber .item .disabled {\n  position: absolute;\n  width: calc(100% - 2px);\n  height: calc(100% - 2px);\n  background-color: gray;\n  top: 0px;\n  opacity: 0.3;\n}\n"],sourceRoot:""}]),t.a=o},function(e,t,n){"use strict";var r=n(1),i=n.n(r),a=n(2),o=n.n(a)()(i.a);o.push([e.i,'.image-upload .item {\n  border: 1px solid #cccccc;\n  text-align: center;\n  height: 120px;\n  width: 120px;\n}\n.image-upload input[type="file"] {\n  opacity: 0;\n  position: relative;\n  height: 120px;\n  width: 120px;\n  top: -100px;\n}\n.image-upload i {\n  margin-top: 20px;\n}\n',"",{version:3,sources:["webpack://./content/image-upload.less"],names:[],mappings:"AAAA;EACE,yBAAyB;EACzB,kBAAkB;EAClB,aAAa;EACb,YAAY;AACd;AACA;EACE,UAAU;EACV,kBAAkB;EAClB,aAAa;EACb,YAAY;EACZ,WAAW;AACb;AACA;EACE,gBAAgB;AAClB",sourcesContent:['.image-upload .item {\n  border: 1px solid #cccccc;\n  text-align: center;\n  height: 120px;\n  width: 120px;\n}\n.image-upload input[type="file"] {\n  opacity: 0;\n  position: relative;\n  height: 120px;\n  width: 120px;\n  top: -100px;\n}\n.image-upload i {\n  margin-top: 20px;\n}\n'],sourceRoot:""}]),t.a=o},function(e,t,n){"use strict";var r=n(1),i=n.n(r),a=n(2),o=n.n(a)()(i.a);o.push([e.i,".image-manager {\n  z-index: 800;\n}\n.image-manager .modal-body .col-xs-2 {\n  margin-top: 6px;\n  margin-bottom: 6px;\n}\n.image-manager .modal-footer .pagination {\n  margin: 0;\n}\n.image-manager .modal-header h4 {\n  margin: 0;\n}\n.image-manager .image-thumber {\n  margin: 10px;\n  float: left;\n  position: relative;\n}\n.image-manager .image-upload {\n  margin: 10px;\n  float: left;\n}\n","",{version:3,sources:["webpack://./content/image-manager.less"],names:[],mappings:"AAAA;EACE,YAAY;AACd;AACA;EACE,eAAe;EACf,kBAAkB;AACpB;AACA;EACE,SAAS;AACX;AACA;EACE,SAAS;AACX;AACA;EACE,YAAY;EACZ,WAAW;EACX,kBAAkB;AACpB;AACA;EACE,YAAY;EACZ,WAAW;AACb",sourcesContent:[".image-manager {\n  z-index: 800;\n}\n.image-manager .modal-body .col-xs-2 {\n  margin-top: 6px;\n  margin-bottom: 6px;\n}\n.image-manager .modal-footer .pagination {\n  margin: 0;\n}\n.image-manager .modal-header h4 {\n  margin: 0;\n}\n.image-manager .image-thumber {\n  margin: 10px;\n  float: left;\n  position: relative;\n}\n.image-manager .image-upload {\n  margin: 10px;\n  float: left;\n}\n"],sourceRoot:""}]),t.a=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),i=n(3);n(13);let a=n(4).getStrings();class o extends r.Component{constructor(e){super(e),this.state={selectedText:""}}setDeleteButton(e,t){e&&i.buttonOnClick(e,e=>(e.stopPropagation(),e.cancelBubble=!0,this.props.remove?this.props.remove(t):Promise.resolve()),{confirm:a.deleteImageConfirm})}render(){let{imagePath:e,className:t,onClick:n,selectedText:a,text:o,title:s,disabled:l}=this.props;return t=t||"",o=o||"",r.createElement("div",{className:"image-thumber "+t,title:s,"data-url":e,onClick:e=>{l||this.props.onClick&&this.props.onClick(this,e)}},r.createElement("div",{className:"item text-center  "+(a?"selected":"")},r.createElement("div",{className:"triangle"}),r.createElement("div",{className:"top"},a),this.props.remove?r.createElement("div",{className:"remove"},r.createElement("i",{className:"fa fa-remove",ref:t=>this.setDeleteButton(t,e)})):null,r.createElement("img",{className:"img-responsive",src:e,ref:e=>e?i.renderImage(e,{imageSize:{width:150,height:150}}):null}),r.createElement("div",{className:"bottom"},o),l?r.createElement("div",{className:"disabled"}):null))}}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),i=n(3);n(14);let a=n(4).getStrings();class o extends r.Component{constructor(e){super(e),this.state={imageSource:e.imageSource}}updloadImage(e){let{width:t,height:n}=this.props;i.imageFileToBase64(e).then(e=>{this.props.saveImage(e),this.setState({imageSource:e.base64})})}setFileInput(e){e&&!e.onchange&&(this.file=e,e.onchange=()=>{null!=e.files&&e.files.length>0&&this.updloadImage(e.files[0])})}componentDidMount(){}setSizes(){let e=this.itemElement.offsetWidth;e<10&&setTimeout(()=>{this.setSizes()},100);let t=e,n=0;this.itemElement.style.height=t+"px",t>80&&(n=(t-80)/2,this.itemElement.style.paddingTop=n+"px"),this.file.style.marginTop=`-${t-n}px`,this.file.style.width=e+"px",this.file.style.height=t+"px"}render(){let{title:e,className:t}=this.props,{imageSource:n}=this.state||{};return e=e||a.imageUpload,t=t||"",r.createElement("div",{className:"image-upload "+t,style:this.props.style},r.createElement("div",{className:"item",ref:e=>this.itemElement=e||this.itemElement},n?r.createElement("img",{src:n,style:{width:"100%",height:"100%"}}):r.createElement(r.Fragment,null,r.createElement("i",{className:"fa fa-plus fa-4x"}),r.createElement("div",null,e)),r.createElement("input",{type:"file",style:{},ref:e=>this.setFileInput(e)})))}}t.default=o},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ImageService=t.errors=void 0;const i=n(19),a=n(20),o=n(3);let s=n(4).getStrings();t.errors={serviceUrlCanntNull:e=>new Error(`Service '${e}' base url can not null.`),unexpectedNullResult:()=>new Error("Null result is unexpected."),unexpectedNullValue:e=>new Error(`variable ${e} is unexpected null value.`),argumentNull:e=>new Error(`Arugment ${e} cannt null or empty.`),fieldNull:(e,t)=>new Error(`${t} ${e} cannt be null or empty`),instanceMessangerStart:()=>new Error("Instance messanger is start."),notSupportedInNode:()=>new Error("Not implement in node environment.")};class l extends i.Service{constructor(){super(e=>l.errorHandle(e))}url(e){return a.pathConcat(l.serviceHost,e)}imageSource(e,t,n){if(!e)return t=null==t?200:t,n=null==n?200:n,e=this.generateImageBase64(t,n,s.noImageText);if(e.startsWith("data:image"))return e;if(null!=e&&(e.startsWith("http://")||e.startsWith("https://")))return e;if(null!=e&&e.indexOf("/")>=0){let r=a.pathConcat(l.serviceHost,e),i="";return null!=t&&(i=i+"&width="+t),null!=n&&(i=i+"&height="+n),i.length>0&&(i=i.substr(1),r=r+"?"+i),r}let r=this.url("image");return r=`${r}?id=${e}`,null!=t&&(r=r+"&width="+t),null!=n&&(r=r+"&height="+n),r}generateImageBase64(e,n,r,i){if(null==document)throw t.errors.notSupportedInNode();var a=document.createElement("canvas");a.width=e,a.height=n;var o=a.getContext("2d");if(null==o)throw new Error("ccreate canvas context fail.");return("string"==typeof r?u.text(r,i):r)(o,e,n),a.toDataURL()}getImageSize(e){if(!e)throw t.errors.argumentNull("imageBase64");return new Promise((t,n)=>{var r=new Image;r.onload=function(){t({width:r.width,height:r.height})},r.src=e})}resize(e,n,i){return r(this,void 0,void 0,(function*(){if(!e)throw t.errors.argumentNull("imageBase64");if(!n)throw t.errors.argumentNull("width");if(!i)throw t.errors.argumentNull("height");var r=document.createElement("canvas"),a=r.getContext("2d");return r.width=n,r.height=i,yield new Promise((t,n)=>{var i=new Image;i.src=e,i.onload=function(){if(null==a)throw"get canvas context fail";a.drawImage(i,0,0,r.width,r.height),t(r.toDataURL())}})}))}list(e){return r(this,void 0,void 0,(function*(){let t=this.url("list");return yield this.postByJson(t,e)}))}upload(e){return r(this,void 0,void 0,(function*(){if(!e)throw t.errors.argumentNull("imageBase64");let n=this.url("upload"),r=yield this.getImageSize(e);if(r.width>800){let t=r.height/r.width*800;e=yield this.resize(e,800,t)}else if(r.height>800){let t=r.width/r.height*800;e=yield this.resize(e,t,800)}return this.postByJson(n,{image:e})}))}remove(e){return r(this,void 0,void 0,(function*(){if(!e)throw t.errors.argumentNull("id");let n=this.url("remove");return this.postByJson(n,{id:e})}))}}t.ImageService=l,l.errorHandle=e=>{o.alert({title:"错误",message:e.message})};let u={text:(e,t)=>(n,r,i)=>{let a=Math.floor(r/e.length*.6);t=t||{},n.fillStyle=t.bgColor||"whitesmoke",n.fillRect(0,0,r,i),n.font=`Bold ${t.fontSize}px Arial`,n.textAlign="left",n.fillStyle=t.textColor||"#999";let o=a*e.length,s=Math.floor(.5*(r-o));Math.floor(.3*(i-(t.fontSize||a)));n.fillText(e,s,Math.floor(.6*i))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageService=t.showImageDialog=t.ImageUpload=t.ImageThumber=void 0;var r=n(9);Object.defineProperty(t,"ImageThumber",{enumerable:!0,get:function(){return r.default}});var i=n(10);Object.defineProperty(t,"ImageUpload",{enumerable:!0,get:function(){return i.default}});var a=n(15);Object.defineProperty(t,"showImageDialog",{enumerable:!0,get:function(){return a.showImageDialog}});var o=n(11);Object.defineProperty(t,"ImageService",{enumerable:!0,get:function(){return o.ImageService}})},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(6),o={insert:"head",singleton:!1};i()(a.a,o);t.default=a.a.locals||{}},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(7),o={insert:"head",singleton:!1};i()(a.a,o);t.default=a.a.locals||{}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.showImageDialog=void 0;const i=n(10),a=n(9),o=n(16),s=n(5),l=n(17),u=n(18),c=n(3),d=n(11),m=n(4);n(22);let h=m.getStrings();class p extends s.Component{constructor(e){super(e),this.state={images:[],selectedItems:[]},this.selectArguments={maximumRows:17},this.dataSource=function(){let e=new d.ImageService;return new o.DataSource({primaryKeys:["id"],select(t){return r(this,void 0,void 0,(function*(){return yield e.list(t)}))},delete(t){return r(this,void 0,void 0,(function*(){return yield e.remove(t.id)}))},insert(t){return r(this,void 0,void 0,(function*(){console.assert(null!=t.data);let n=yield e.upload(t.data);return Object.assign(t,n),n}))}})}(),this.dataSource.selected.add(e=>{this.setState({images:e.selectResult.dataItems})}),this.dataSource.inserted.add(e=>{this.state.images.push(e.dataItem),this.setState({images:this.state.images})}),this.imageService=new d.ImageService}componentDidMount(){return r(this,void 0,void 0,(function*(){new o.DataSourcePagingBar({dataSource:this.dataSource,element:this.pagingBarElement,pagerSettings:{activeButtonClassName:"active",buttonWrapper:"li",buttonContainerWraper:"ul",showTotal:!1}});let e=this.pagingBarElement.querySelector("ul");e&&(e.className="pagination")}))}show(e,t){this.showDialogCallback=t,this.selectArguments.startRowIndex=0,this.dataSource.select(this.selectArguments),this.setState({selectedItems:[],selectedMax:e}),c.showDialog(this.props.element)}saveImage(e){return r(this,void 0,void 0,(function*(){this.dataSource.insert({data:e})}))}removeImage(e){this.dataSource.delete(e);let t=this.state.images;t=t.filter(t=>t.id!=e.id),this.setState({images:t})}render(){let{images:e,selectedItems:t,selectedMax:n}=this.state,r=this.props.element;return s.createElement("div",{className:"modal-dialog modal-lg"},s.createElement("div",{className:"modal-content"},s.createElement("div",{className:"modal-header"},s.createElement("button",{type:"button",className:"btn close",onClick:()=>c.hideDialog(r)},s.createElement("span",{"aria-hidden":"true"},"×")),s.createElement("h4",{className:"modal-title"},h.selectImage)),s.createElement("div",{className:"modal-body"},e.map(e=>{let r=t.indexOf(e.id)>=0?""+(t.indexOf(e.id)+1):"",i=t.length==n;return s.createElement(a.default,{key:e.id,imagePath:this.imageService.imageSource(e.id,150,150),remove:()=>this.removeImage(e),selectedText:r,disabled:i&&!r,text:null!=e.width&&null!=e.height?`${e.width} X ${e.height}`:" ",onClick:()=>{let t=this.state.selectedItems;if(t.indexOf(e.id)>=0)t=t.filter(t=>t!=e.id);else{if(t.length==n)return;t.push(e.id)}this.setState({selectedItems:t})}})}),s.createElement(i.default,{saveImage:e=>this.saveImage(e.base64),width:400}),s.createElement("div",{className:"clearfix"})),s.createElement("div",{className:"modal-footer"},s.createElement("div",{className:"pull-left",ref:e=>this.pagingBarElement=e||this.pagingBarElement}),n?s.createElement("div",{className:"pull-left",style:{paddingTop:8,paddingLeft:10}},h.selectMax,s.createElement("b",{style:{padding:"0 2px 0 2px"}},n),"张"):null,s.createElement("button",{name:"cancel",type:"button",className:"btn btn-default",onClick:()=>c.hideDialog(r)},h.cancel),s.createElement("button",{name:"ok",type:"button",className:"btn btn-primary",disabled:0==t.length,onClick:()=>{if(this.showDialogCallback){let e=this.state.selectedItems.map(e=>e);this.showDialogCallback(e)}c.hideDialog(r)}},h.confirm))))}}let f=u.createDialogElement("image-manager"),g=l.render(s.createElement(p,{element:f}),f);t.default={show(e){g.show(void 0,e)}},t.showImageDialog=function(e,t){"function"==typeof e&&(t=e=null),g.show(e,t)}},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDialogElement=t.imageUrl=void 0,t.imageUrl=function(e,t,n){if(!e)return e;if(e.startsWith("data:image"))return e;if(e.indexOf(",")>0&&(e=e.split(",")[0]),e.startsWith("http://")){let t=(e=e.substr("http://".length)).indexOf("/");console.assert(t>0),e=e.substr(t)}else"/"==e[0]&&(e=e.substr(1));let r=new Array,i=(location.protocol,""+e);return t&&(r.push({name:"width",value:t.toString()}),n&&r.push({name:"height",value:n.toString()})),navigator.userAgent.indexOf("chrome")<0&&r.push({name:"type",value:"jpeg"}),r.length>0&&(i=i+"?"+r.map(e=>`${e.name}=${e.value}`).join("&")),i},t.createDialogElement=function(e){let t=document.createElement("div");return t.className="modal fade "+e,t.style.zIndex="1000",document.body.appendChild(t),t}},function(e,t){e.exports=i},function(e,t,n){(function(t){
/*!
 * ~
 *  maishu-toolkit v1.6.0
 *  https://github.com/ansiboy/toolkit
 *  
 *  Copyright (c) 2016-2018, shu mai <ansiboy@163.com>
 *  Licensed under the MIT License.
 * 
 */
var n;"undefined"==typeof window||window,n=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./out/index.js")}({"./out/assign-deep.js":
/*!****************************!*\
  !*** ./out/assign-deep.js ***!
  \****************************/
/*! exports provided: objectAssignDeep, objectAssignDeepInto, withOptions */function(e,t,n){"use strict";function r(e){return null===e?"null":void 0===e?"undefined":"object"==typeof e?Array.isArray(e)?"array":"object":typeof e}function i(e){return"object"===r(e)?o(e):"array"===r(e)?a(e):e}function a(e){return e.map(i)}function o(e){const t={};for(const n in e)e.hasOwnProperty(n)&&(t[n]=i(e[n]));return t}function s(e,t=[],n={}){const i={arrayBehaviour:n.arrayBehaviour||"replace"},l=t.map(e=>e||{}),u=e||{};for(let e=0;e<l.length;e++){const t=l[e],n=Object.keys(t);for(let e=0;e<n.length;e++){const l=n[e],c=t[l],d=r(c),m=r(u[l]);if("object"===d)if("undefined"!==m){const e="object"===m?u[l]:{};u[l]=s({},[e,o(c)],i)}else u[l]=o(c);else if("array"===d)if("array"===m){const e=a(c);u[l]="merge"===i.arrayBehaviour?u[l].concat(e):e}else u[l]=a(c);else u[l]=c}}return u}function l(e,...t){return s(e,t)}function u(...e){return s({},e)}n.r(t),n.d(t,"objectAssignDeep",(function(){return l})),n.d(t,"objectAssignDeepInto",(function(){return u})),n.d(t,"withOptions",(function(){return c}));let c=function(e,t,n){return s(e,t,n)}},"./out/callback.js":
/*!*************************!*\
  !*** ./out/callback.js ***!
  \*************************/
/*! exports provided: Callback */function(e,t,n){"use strict";n.r(t),n.d(t,"Callback",(function(){return r}));class r{constructor(){this.funcs=new Array}add(e){this.funcs.push(e)}remove(e){this.funcs=this.funcs.filter(t=>t!=e)}fire(e){this.funcs.forEach(t=>t(e))}static create(){return new r}}},"./out/data.js":
/*!*********************!*\
  !*** ./out/data.js ***!
  \*********************/
/*! exports provided: DataSource, DataSourceSelectArguments */function(e,t,n){"use strict";n.r(t),n.d(t,"DataSource",(function(){return o})),n.d(t,"DataSourceSelectArguments",(function(){return s}));var r=n(/*! ./errors */"./out/errors.js"),i=n(/*! ./callback */"./out/callback.js");let a=Object.assign(r.errors,{dataSourceCanntInsert:()=>new Error("DataSource can not insert."),dataSourceCanntDelete:()=>new Error("DataSource can not delete."),dataSourceCanntUpdate:()=>new Error("DataSource can not update."),primaryKeyNull:e=>new Error(`Primary key named '${e}' value is null.`),queryResultTypeError:()=>new Error("Query result type error.")});class o{constructor(e){this.inserting=new i.Callback,this.inserted=new i.Callback,this.deleting=new i.Callback,this.deleted=new i.Callback,this.updating=new i.Callback,this.updated=new i.Callback,this.selecting=new i.Callback,this.selected=new i.Callback,this.error=new i.Callback,this.args=e,this.primaryKeys=e.primaryKeys||[]}get canDelete(){return null!=this.args.delete&&this.primaryKeys.length>0}get canInsert(){return null!=this.args.insert&&this.primaryKeys.length>0}get canUpdate(){return null!=this.args.update&&this.primaryKeys.length>0}executeInsert(e,t){return this.args.insert(e,t)}executeDelete(e,t){return this.args.delete(e,t)}executeUpdate(e,t){return this.args.update(e,t)}executeSelect(e){return e=e||{},this.args.select(e)}insert(e,t,n){if(!this.canInsert)throw a.dataSourceCanntInsert();if(!e)throw a.argumentNull("item");return"number"==typeof t&&(n=t,t=null),this.inserting.fire({sender:this,dataItem:e,index:n}),this.executeInsert(e,t).then(t=>(Object.assign(e,t),this.inserted.fire({sender:this,dataItem:e,index:n}),t)).catch(e=>{throw this.processError(e,"insert"),e})}delete(e,t){if(!this.canDelete)throw a.dataSourceCanntDelete();if(!e)throw a.argumentNull("item");return this.checkPrimaryKeys(e),this.deleting.fire({sender:this,dataItem:e}),this.executeDelete(e,t).then(t=>(this.deleted.fire({sender:this,dataItem:e}),t)).catch(e=>{throw this.processError(e,"delete"),e})}update(e,t){if(!this.canUpdate)throw a.dataSourceCanntUpdate();if(!e)throw a.argumentNull("item");return this.checkPrimaryKeys(e),this.updating.fire({sender:this,dataItem:e}),this.executeUpdate(e,t).then(t=>(Object.assign(e,t),this.updated.fire({sender:this,dataItem:e}),t)).catch(e=>{throw this.processError(e,"update"),e})}isSameItem(e,t){if(null==e)throw a.argumentNull("theItem");if(null==t)throw a.argumentNull("otherItem");if(0==this.primaryKeys.length)return e==t;this.checkPrimaryKeys(e),this.checkPrimaryKeys(t);for(let n of this.primaryKeys)if(e[n]!=t[n])return!1;return!0}checkPrimaryKeys(e){for(let t in e)if(null==e[t]&&this.primaryKeys.indexOf(t)>=0)throw a.primaryKeyNull(t)}select(e){return e=e||{},this.selecting.fire({sender:this,selectArguments:e}),this.executeSelect(e).then(t=>{let n,r;if(Array.isArray(t))n=t,r=t.length;else{if(void 0===t.dataItems||void 0===t.totalRowCount)throw a.queryResultTypeError();n=t.dataItems,r=t.totalRowCount}return this.selected.fire({sender:this,selectResult:{totalRowCount:r,dataItems:n},selectArguments:e}),{totalRowCount:r,dataItems:n}}).catch(e=>{throw this.processError(e,"select"),e})}processError(e,t){if(e.method=t,this.error.fire({sender:this,error:e}),!e.handled)throw e}}class s{constructor(){this.startRowIndex=0,this.maximumRows=2147483647}}},"./out/deep-equal.js":
/*!***************************!*\
  !*** ./out/deep-equal.js ***!
  \***************************/
/*! exports provided: deepEqual */function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;if("object"==typeof e&&null!=e&&"object"==typeof t&&null!=t){if(Object.keys(e).length!=Object.keys(t).length)return!1;for(var n in e){if(!t.hasOwnProperty(n))return!1;if(!r(e[n],t[n]))return!1}return!0}return!1}n.r(t),n.d(t,"deepEqual",(function(){return r}))},"./out/errors.js":
/*!***********************!*\
  !*** ./out/errors.js ***!
  \***********************/
/*! exports provided: Errors, errors */function(e,t,n){"use strict";n.r(t),n.d(t,"Errors",(function(){return r})),n.d(t,"errors",(function(){return i}));class r{argumentNull(e){let t=new Error(`Argument ${e} cannt be null or emtpy.`);return t.name="argumentNull",t}routeDataFieldNull(e){let t=new Error(`The ${e} field of route data cannt be null.`);return t.name="routeDataFieldNull",t}argumentFieldNull(e,t){let n=new Error(`The ${e} field of ${t} cannt be null.`);return n.name="argumentFieldNull",n}argumentTypeIncorrect(e,t){let n=new Error(`Argument ${e} type error, expected type is ${t}.`);return n.name="argumentTypeIncorrect",n}}let i=new r},"./out/format-date.js":
/*!****************************!*\
  !*** ./out/format-date.js ***!
  \****************************/
/*! exports provided: formatDate */function(e,t,n){"use strict";function r(e,t){if("string"==typeof e)return e;let n=e;return t?`${n.getFullYear()}-${n.getMonth()}-${n.getDate()} ${n.getHours()+1}:${n.getMinutes()}`:`${n.getFullYear()}-${n.getMonth()}-${n.getDate()}`}n.r(t),n.d(t,"formatDate",(function(){return r}))},"./out/guid.js":
/*!*********************!*\
  !*** ./out/guid.js ***!
  \*********************/
/*! exports provided: guid */function(e,t,n){"use strict";function r(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}n.r(t),n.d(t,"guid",(function(){return r}))},"./out/html.js":
/*!*********************!*\
  !*** ./out/html.js ***!
  \*********************/
/*! exports provided: HTML */function(e,t,n){"use strict";n.r(t),n.d(t,"HTML",(function(){return i}));var r=n(/*! ./errors */"./out/errors.js");class i{static addClassName(e,t){if(null==e)throw r.errors.argumentNull("element");if(!t)throw r.errors.argumentNull("addonClassName");let n;if(n="string"==typeof e?e:e.className,n=n||"",console.assert(null!=t),n.indexOf(t)>=0)return n;let i=`${n} ${t}`;return"string"!=typeof e&&(e.className=i),i}static removeClassName(e,t){let n;return n="string"==typeof e?e:e.className||"",n.indexOf(t)<0||(n=n||"",n=n.replace(new RegExp(t,"g"),""),n=n.trim(),"string"!=typeof e&&(e.className=n)),n}}},"./out/index.js":
/*!**********************!*\
  !*** ./out/index.js ***!
  \**********************/
/*! exports provided: guid, pathConcat, Errors, errors, Callback, DataSource, DataSourceSelectArguments, parseUrl, deepEqual, objectAssignDeep, formatDate, HTML, ValueStore */function(e,t,n){"use strict";n.r(t);var r=n(/*! ./guid */"./out/guid.js");n.d(t,"guid",(function(){return r.guid}));var i=n(/*! ./path */"./out/path.js");n.d(t,"pathConcat",(function(){return i.pathConcat}));var a=n(/*! ./errors */"./out/errors.js");n.d(t,"Errors",(function(){return a.Errors})),n.d(t,"errors",(function(){return a.errors}));var o=n(/*! ./callback */"./out/callback.js");n.d(t,"Callback",(function(){return o.Callback}));var s=n(/*! ./data */"./out/data.js");n.d(t,"DataSource",(function(){return s.DataSource})),n.d(t,"DataSourceSelectArguments",(function(){return s.DataSourceSelectArguments}));var l=n(/*! ./url */"./out/url.js");n.d(t,"parseUrl",(function(){return l.parseUrl}));var u=n(/*! ./deep-equal */"./out/deep-equal.js");n.d(t,"deepEqual",(function(){return u.deepEqual}));var c=n(/*! ./assign-deep */"./out/assign-deep.js");n.d(t,"objectAssignDeep",(function(){return c.objectAssignDeep}));var d=n(/*! ./format-date */"./out/format-date.js");n.d(t,"formatDate",(function(){return d.formatDate}));var m=n(/*! ./html */"./out/html.js");n.d(t,"HTML",(function(){return m.HTML}));var h=n(/*! ./value-store */"./out/value-store.js");n.d(t,"ValueStore",(function(){return h.ValueStore}))},"./out/path.js":
/*!*********************!*\
  !*** ./out/path.js ***!
  \*********************/
/*! exports provided: pathConcat */function(e,t,n){"use strict";function r(...e){if(0==(e=e||[]).length)return"";if(1==e.length)return e[0];let t=e.join("/");return t=t.replace(/(\/+|\\+)/g,"/"),t=t.replace("http:/","http://"),t=t.replace("https:/","https://"),t}n.r(t),n.d(t,"pathConcat",(function(){return r}))},"./out/url.js":
/*!********************!*\
  !*** ./out/url.js ***!
  \********************/
/*! exports provided: parseUrl */function(e,t,n){"use strict";function r(e){let t=e.indexOf("?");return t<0?{}:function(e){let t,n=/\+/g,r=/([^&=]+)=?([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(n," "))},a={};for(;t=r.exec(e);)a[i(t[1])]=i(t[2]);return a}(e.substr(t+1))}n.r(t),n.d(t,"parseUrl",(function(){return r}))},"./out/value-store.js":
/*!****************************!*\
  !*** ./out/value-store.js ***!
  \****************************/
/*! exports provided: ValueStore */function(e,t,n){"use strict";n.r(t),n.d(t,"ValueStore",(function(){return r}));class r{constructor(e){this.items=new Array,this._value=e}attach(e,t){return void 0!==this.value&&e(this.value,t),this.add(e,t)}add(e,t){return this.items.push({func:e,sender:t}),e}remove(e){this.items=this.items.filter(t=>t.func!=e)}fire(e){this.items.forEach(t=>t.func(e,t.sender))}get value(){return void 0===this._value?null:this._value}set value(e){this._value=e,this.fire(e)}}}})},e.exports=n()}).call(this,n(21))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(8),o={insert:"head",singleton:!1};i()(a.a,o);t.default=a.a.locals||{}}])}));
//# sourceMappingURL=index.min.js.map