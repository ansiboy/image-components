/*!
 * 
 *  maishu-image-components v1.5.8
 * 
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("maishu-ui-toolkit"),require("maishu-toolkit"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","maishu-ui-toolkit","maishu-toolkit","react-dom"],t):"object"==typeof exports?exports["image-components"]=t(require("react"),require("maishu-ui-toolkit"),require("maishu-toolkit"),require("react-dom")):e["image-components"]=t(e.react,e["maishu-ui-toolkit"],e["maishu-toolkit"],e["react-dom"])}(window,(function(__WEBPACK_EXTERNAL_MODULE__3__,__WEBPACK_EXTERNAL_MODULE__4__,__WEBPACK_EXTERNAL_MODULE__6__,__WEBPACK_EXTERNAL_MODULE__13__){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=17)}([function(e,t,n){"use strict";var r,i=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),o=[];function s(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].identifier===e){t=n;break}return t}function l(e,t){for(var n={},r=[],i=0;i<e.length;i++){var a=e[i],l=t.base?a[0]+t.base:a[0],u=n[l]||0,c="".concat(l," ").concat(u);n[l]=u+1;var d=s(c),m={css:a[1],media:a[2],sourceMap:a[3]};-1!==d?(o[d].references++,o[d].updater(m)):o.push({identifier:c,updater:f(m,t),references:1}),r.push(c)}return r}function u(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var i=n.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var o=a(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,d=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function m(e,t,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=d(t,i);else{var a=document.createTextNode(i),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}function p(e,t,n){var r=n.css,i=n.media,a=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var h=null,g=0;function f(e,t){var n,r,i;if(t.singleton){var a=g++;n=h||(h=u(t)),r=m.bind(null,n,a,!1),i=m.bind(null,n,a,!0)}else n=u(t),r=p.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=i());var n=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var i=s(n[r]);o[i].references--}for(var a=l(e,t),u=0;u<n.length;u++){var c=s(n[u]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}n=a}}}},function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.exports=function(e){var t=r(e,4),n=t[1],i=t[3];if("function"==typeof btoa){var a=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),s="/*# ".concat(o," */"),l=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(e," */")}));return[n].concat(l).concat([s]).join("\n")}return[n].join("\n")}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(i[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);r&&i[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__3__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__4__},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setLanguage=t.getStrings=void 0;let r={chinese:{selectImage:"选择图片",selectMax:"最多可选",cancel:"取消",confirm:"确定",deleteImageConfirm:"确定删除该图片吗？",imageUpload:"图片上传",noImageText:"暂无图片",dataLoading:"数据正在加载中...",dataEmpty:"暂无所要展示的数据"},english:{selectImage:"Select Image",selectMax:"Select Max",cancel:"Cancel",confirm:"Confirm",deleteImageConfirm:"Are you sure delete the image?",imageUpload:"Image Upload",noImageText:"NO IMAGE",dataLoading:"Data is loading...",dataEmpty:"Data is empty"}};t.getStrings=function(e){return e=e||a(),r[e]};let i="chinese";function a(){return i}t.setLanguage=function(e){i=e}},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__6__},function(e,t,n){"use strict";var r=n(1),i=n.n(r),a=n(2),o=n.n(a)()(i.a);o.push([e.i,".image-thumber {\n  position: relative;\n}\n.image-thumber .item {\n  border: solid 1px #ccc;\n  height: calc(100% - 2px);\n}\n.image-thumber .item .bottom {\n  display: block;\n  overflow: hidden;\n  white-space: nowrap;\n  -webkit-text-overflow: ellipsis;\n  -ms-text-overflow: ellipsis;\n  -o-text-overflow: ellipsis;\n  text-overflow: ellipsis;\n  position: absolute;\n  bottom: 0;\n  padding: 4px 8px 0px 8px;\n  font-size: 12px;\n  text-align: center;\n  background-color: rgba(0, 0, 0, 0.55);\n  color: white;\n  width: calc(100% - 2px);\n  height: 24px;\n}\n.image-thumber .item .bottom button {\n  color: white;\n}\n.image-thumber .item .top {\n  position: absolute;\n  height: 18px;\n  margin-top: -18px;\n  padding-top: 18px;\n  color: white;\n  font-size: 12px;\n  font-weight: bold;\n  text-align: right;\n  width: calc(100% - 2px);\n}\n.image-thumber .item.selected {\n  border-color: blue;\n}\n.image-thumber .item.selected .triangle {\n  position: relative;\n  top: 19px;\n  left: calc(100% - 19px);\n  width: 20px;\n  height: 20px;\n  margin-top: -40px;\n  background: transparent;\n  border-top: 20px solid transparent;\n  border-bottom: 20px solid blue;\n  border-left: 20px solid transparent;\n  border-right: 20px solid transparent;\n  transform: rotate(45deg);\n}\n.image-thumber .item.selected:hover .remove {\n  display: none;\n}\n.image-thumber .item .remove {\n  display: none;\n}\n.image-thumber .item:hover .remove {\n  position: relative;\n  left: calc(100% - 20px);\n  top: 20px;\n  width: 20px;\n  height: 20px;\n  border-radius: 10px;\n  margin-top: -20px;\n  display: block;\n  background-color: rgba(0, 0, 0, 0.55);\n}\n.image-thumber .item:hover .remove i {\n  color: white;\n}\n.image-thumber .item .disabled {\n  position: absolute;\n  width: calc(100% - 2px);\n  height: calc(100% - 2px);\n  background-color: gray;\n  top: 0px;\n  opacity: 0.3;\n}\n","",{version:3,sources:["webpack://./content/image-thumber.less"],names:[],mappings:"AAAA;EACE,kBAAkB;AACpB;AACA;EACE,sBAAsB;EACtB,wBAAwB;AAC1B;AACA;EACE,cAAc;EACd,gBAAgB;EAChB,mBAAmB;EACnB,+BAA+B;EAC/B,2BAA2B;EAC3B,0BAA0B;EAC1B,uBAAuB;EACvB,kBAAkB;EAClB,SAAS;EACT,wBAAwB;EACxB,eAAe;EACf,kBAAkB;EAClB,qCAAqC;EACrC,YAAY;EACZ,uBAAuB;EACvB,YAAY;AACd;AACA;EACE,YAAY;AACd;AACA;EACE,kBAAkB;EAClB,YAAY;EACZ,iBAAiB;EACjB,iBAAiB;EACjB,YAAY;EACZ,eAAe;EACf,iBAAiB;EACjB,iBAAiB;EACjB,uBAAuB;AACzB;AACA;EACE,kBAAkB;AACpB;AACA;EACE,kBAAkB;EAClB,SAAS;EACT,uBAAuB;EACvB,WAAW;EACX,YAAY;EACZ,iBAAiB;EACjB,uBAAuB;EACvB,kCAAkC;EAClC,8BAA8B;EAC9B,mCAAmC;EACnC,oCAAoC;EACpC,wBAAwB;AAC1B;AACA;EACE,aAAa;AACf;AACA;EACE,aAAa;AACf;AACA;EACE,kBAAkB;EAClB,uBAAuB;EACvB,SAAS;EACT,WAAW;EACX,YAAY;EACZ,mBAAmB;EACnB,iBAAiB;EACjB,cAAc;EACd,qCAAqC;AACvC;AACA;EACE,YAAY;AACd;AACA;EACE,kBAAkB;EAClB,uBAAuB;EACvB,wBAAwB;EACxB,sBAAsB;EACtB,QAAQ;EACR,YAAY;AACd",sourcesContent:[".image-thumber {\n  position: relative;\n}\n.image-thumber .item {\n  border: solid 1px #ccc;\n  height: calc(100% - 2px);\n}\n.image-thumber .item .bottom {\n  display: block;\n  overflow: hidden;\n  white-space: nowrap;\n  -webkit-text-overflow: ellipsis;\n  -ms-text-overflow: ellipsis;\n  -o-text-overflow: ellipsis;\n  text-overflow: ellipsis;\n  position: absolute;\n  bottom: 0;\n  padding: 4px 8px 0px 8px;\n  font-size: 12px;\n  text-align: center;\n  background-color: rgba(0, 0, 0, 0.55);\n  color: white;\n  width: calc(100% - 2px);\n  height: 24px;\n}\n.image-thumber .item .bottom button {\n  color: white;\n}\n.image-thumber .item .top {\n  position: absolute;\n  height: 18px;\n  margin-top: -18px;\n  padding-top: 18px;\n  color: white;\n  font-size: 12px;\n  font-weight: bold;\n  text-align: right;\n  width: calc(100% - 2px);\n}\n.image-thumber .item.selected {\n  border-color: blue;\n}\n.image-thumber .item.selected .triangle {\n  position: relative;\n  top: 19px;\n  left: calc(100% - 19px);\n  width: 20px;\n  height: 20px;\n  margin-top: -40px;\n  background: transparent;\n  border-top: 20px solid transparent;\n  border-bottom: 20px solid blue;\n  border-left: 20px solid transparent;\n  border-right: 20px solid transparent;\n  transform: rotate(45deg);\n}\n.image-thumber .item.selected:hover .remove {\n  display: none;\n}\n.image-thumber .item .remove {\n  display: none;\n}\n.image-thumber .item:hover .remove {\n  position: relative;\n  left: calc(100% - 20px);\n  top: 20px;\n  width: 20px;\n  height: 20px;\n  border-radius: 10px;\n  margin-top: -20px;\n  display: block;\n  background-color: rgba(0, 0, 0, 0.55);\n}\n.image-thumber .item:hover .remove i {\n  color: white;\n}\n.image-thumber .item .disabled {\n  position: absolute;\n  width: calc(100% - 2px);\n  height: calc(100% - 2px);\n  background-color: gray;\n  top: 0px;\n  opacity: 0.3;\n}\n"],sourceRoot:""}]),t.a=o},function(e,t,n){"use strict";var r=n(1),i=n.n(r),a=n(2),o=n.n(a)()(i.a);o.push([e.i,'.image-upload .item {\n  border: 1px solid #cccccc;\n  text-align: center;\n  height: 120px;\n  width: 120px;\n}\n.image-upload input[type="file"] {\n  opacity: 0;\n  position: relative;\n  height: 120px;\n  width: 120px;\n  top: -100px;\n  cursor: pointer;\n}\n.image-upload i {\n  margin-top: 20px;\n}\n',"",{version:3,sources:["webpack://./content/image-upload.less"],names:[],mappings:"AAAA;EACE,yBAAyB;EACzB,kBAAkB;EAClB,aAAa;EACb,YAAY;AACd;AACA;EACE,UAAU;EACV,kBAAkB;EAClB,aAAa;EACb,YAAY;EACZ,WAAW;EACX,eAAe;AACjB;AACA;EACE,gBAAgB;AAClB",sourcesContent:['.image-upload .item {\n  border: 1px solid #cccccc;\n  text-align: center;\n  height: 120px;\n  width: 120px;\n}\n.image-upload input[type="file"] {\n  opacity: 0;\n  position: relative;\n  height: 120px;\n  width: 120px;\n  top: -100px;\n  cursor: pointer;\n}\n.image-upload i {\n  margin-top: 20px;\n}\n'],sourceRoot:""}]),t.a=o},function(e,t,n){"use strict";var r=n(1),i=n.n(r),a=n(2),o=n.n(a)()(i.a);o.push([e.i,".image-manager {\n  z-index: 800;\n}\n.image-manager .modal-body .col-xs-2 {\n  margin-top: 6px;\n  margin-bottom: 6px;\n}\n.image-manager .modal-footer .pagination {\n  margin: 0;\n}\n.image-manager .modal-header h4 {\n  margin: 0;\n}\n.image-manager .image-thumber {\n  margin: 10px;\n  float: left;\n  position: relative;\n}\n.image-manager .image-upload {\n  margin: 10px;\n  float: left;\n}\n","",{version:3,sources:["webpack://./content/image-manager.less"],names:[],mappings:"AAAA;EACE,YAAY;AACd;AACA;EACE,eAAe;EACf,kBAAkB;AACpB;AACA;EACE,SAAS;AACX;AACA;EACE,SAAS;AACX;AACA;EACE,YAAY;EACZ,WAAW;EACX,kBAAkB;AACpB;AACA;EACE,YAAY;EACZ,WAAW;AACb",sourcesContent:[".image-manager {\n  z-index: 800;\n}\n.image-manager .modal-body .col-xs-2 {\n  margin-top: 6px;\n  margin-bottom: 6px;\n}\n.image-manager .modal-footer .pagination {\n  margin: 0;\n}\n.image-manager .modal-header h4 {\n  margin: 0;\n}\n.image-manager .image-thumber {\n  margin: 10px;\n  float: left;\n  position: relative;\n}\n.image-manager .image-upload {\n  margin: 10px;\n  float: left;\n}\n"],sourceRoot:""}]),t.a=o},function(e,t,n){"use strict";var r=n(1),i=n.n(r),a=n(2),o=n.n(a)()(i.a);o.push([e.i,".data-source-dialog .modal-footer .pagination {\n  float: left;\n  margin: 0;\n}\n.data-source-dialog .modal-body {\n  min-height: 300px;\n}\n.data-source-dialog .empty {\n  text-align: center;\n  padding: 120px;\n  width: 100%;\n}\n","",{version:3,sources:["webpack://./content/data-source-dialog.less"],names:[],mappings:"AAAA;EACE,WAAW;EACX,SAAS;AACX;AACA;EACE,iBAAiB;AACnB;AACA;EACE,kBAAkB;EAClB,cAAc;EACd,WAAW;AACb",sourcesContent:[".data-source-dialog .modal-footer .pagination {\n  float: left;\n  margin: 0;\n}\n.data-source-dialog .modal-body {\n  min-height: 300px;\n}\n.data-source-dialog .empty {\n  text-align: center;\n  padding: 120px;\n  width: 100%;\n}\n"],sourceRoot:""}]),t.a=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(3),i=n(4);n(18);let a=n(5).getStrings();class o extends r.Component{constructor(e){super(e),this.state={selectedText:e.selectedText}}setDeleteButton(e,t){e&&i.buttonOnClick(e,e=>(e.stopPropagation(),e.cancelBubble=!0,this.props.remove?this.props.remove(t):Promise.resolve()),{confirm:a.deleteImageConfirm})}render(){let{imagePath:e,onClick:t,title:n,disabled:i}=this.props,{selectedText:a}=this.state,o=this.props.className,s=this.props.text;return o=o||"",s=s||"",r.createElement("div",{className:"image-thumber "+o,title:n,"data-url":e,onClick:e=>{i||t&&t(this,e)}},r.createElement("div",{className:"item text-center  "+(a?"selected":"")},r.createElement("div",{className:"triangle"}),r.createElement("div",{className:"top"},a),this.props.remove?r.createElement("div",{className:"remove"},r.createElement("i",{className:"fa fa-remove",ref:t=>this.setDeleteButton(t,e)})):null,r.createElement("img",{className:"img-responsive",src:e}),s?r.createElement("div",{className:"bottom"},s):null,i?r.createElement("div",{className:"disabled"}):null,this.props.children))}}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(3),i=n(4);n(19);const a=n(5),o=n(13);let s=a.getStrings();class l extends r.Component{constructor(e){var t;super(e),this.state={imageSource:null===(t=e.displayImage)||void 0===t?void 0:t.source}}updloadImage(e){let{width:t,height:n}=this.props;i.imageFileToBase64(e).then(e=>{this.props.saveImage(e),this.setState({imageSource:e.base64})})}setFileInput(e){e&&!e.onchange&&(this.file=e,e.onchange=()=>{null!=e.files&&e.files.length>0&&this.updloadImage(e.files[0])})}setSizes(){let e=this.itemElement.offsetWidth;e<10&&setTimeout(()=>{this.setSizes()},100);let t=e,n=0;this.itemElement.style.height=t+"px",t>80&&(n=(t-80)/2,this.itemElement.style.paddingTop=n+"px"),this.file.style.marginTop=`-${t-n}px`,this.file.style.width=e+"px",this.file.style.height=t+"px"}render(){let{title:e,className:t}=this.props,{imageSource:n}=this.state||{};return e=e||s.imageUpload,t=t||"",null==n||null==this.props.displayImage?r.createElement("div",{className:"image-upload "+t,style:this.props.style},r.createElement("div",{className:"item",ref:e=>this.itemElement=e||this.itemElement},r.createElement(r.Fragment,null,r.createElement("i",{className:"fa fa-plus fa-4x"}),r.createElement("div",null,e)),r.createElement("input",{type:"file",style:{},ref:e=>this.setFileInput(e)}))):this.props.displayImage.fixed?r.createElement("div",{className:"image-upload "+t,style:this.props.style},r.createElement("div",{className:"item",ref:e=>this.itemElement=e||this.itemElement},r.createElement("img",{src:n,style:{width:"100%",height:"100%"}}),r.createElement("input",{type:"file",style:{},ref:e=>this.setFileInput(e)}))):r.createElement("div",{className:"image-upload "+t,ref:e=>{if(!e)return;let t=document.createElement("img");t.src=n,t.onload=t=>{var n;let r=t.target.width,i=t.target.height,a=null===(n=this.props.displayImage)||void 0===n?void 0:n.maxWidth;if(a){i=a*(i/r),r=a}e.style.backgroundImage=`url(${t.target.src})`,e.style.backgroundSize=`${r}px ${i}px`,e.style.backgroundRepeat="no-repeat";let o=e.querySelector('[type="file"]');o.style.width=r+"px",o.style.height=i+"px"},o.render(r.createElement(r.Fragment,null,r.createElement("input",{type:"file",style:{opacity:0},ref:e=>this.setFileInput(e)})),e)}})}}t.default=l},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__13__},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ImageService=t.errors=void 0;const i=n(22),a=n(6),o=n(24);let s=n(5).getStrings();t.errors={serviceUrlCanntNull:e=>new Error(`Service '${e}' base url can not null.`),unexpectedNullResult:()=>new Error("Null result is unexpected."),unexpectedNullValue:e=>new Error(`variable ${e} is unexpected null value.`),argumentNull:e=>new Error(`Arugment ${e} cannt null or empty.`),fieldNull:(e,t)=>new Error(`${t} ${e} cannt be null or empty`),instanceMessangerStart:()=>new Error("Instance messanger is start."),notSupportedInNode:()=>new Error("Not implement in node environment.")};class l extends i.Service{constructor(){super(e=>o.errorHandle(e))}url(e){return a.pathConcat(l.serviceHost,e)}imageSource(e,t,n){if(!e)return t=null==t?200:t,n=null==n?200:n,e=this.generateImageBase64(t,n,s.noImageText);if(e.startsWith("data:image"))return e;if(null!=e&&(e.startsWith("http://")||e.startsWith("https://")))return e;if(null!=e&&e.indexOf("/")>=0){let r=a.pathConcat(l.serviceHost,e),i="";return null!=t&&(i=i+"&width="+t),null!=n&&(i=i+"&height="+n),i.length>0&&(i=i.substr(1),r=r+"?"+i),r}let r=this.url("image");return r=`${r}?id=${e}`,null!=t&&(r=r+"&width="+t),null!=n&&(r=r+"&height="+n),r}generateImageBase64(e,n,r,i){if(null==document)throw t.errors.notSupportedInNode();var a=document.createElement("canvas");a.width=e,a.height=n;var o=a.getContext("2d");if(null==o)throw new Error("ccreate canvas context fail.");return("string"==typeof r?u.text(r,i):r)(o,e,n),a.toDataURL()}getImageSize(e){if(!e)throw t.errors.argumentNull("imageBase64");return new Promise((t,n)=>{var r=new Image;r.onload=function(){t({width:r.width,height:r.height})},r.src=e})}resize(e,n,i){return r(this,void 0,void 0,(function*(){if(!e)throw t.errors.argumentNull("imageBase64");if(!n)throw t.errors.argumentNull("width");if(!i)throw t.errors.argumentNull("height");var r=document.createElement("canvas"),a=r.getContext("2d");return r.width=n,r.height=i,yield new Promise((t,n)=>{var i=new Image;i.src=e,i.onload=function(){if(null==a)throw"get canvas context fail";a.drawImage(i,0,0,r.width,r.height),t(r.toDataURL())}})}))}list(e){return r(this,void 0,void 0,(function*(){let t=this.url("list");return yield this.postByJson(t,e)}))}upload(e){return r(this,void 0,void 0,(function*(){if(!e)throw t.errors.argumentNull("imageBase64");let n=this.url("upload"),r=yield this.getImageSize(e);if(r.width>800){let t=r.height/r.width*800;e=yield this.resize(e,800,t)}else if(r.height>800){let t=r.width/r.height*800;e=yield this.resize(e,t,800)}return this.postByJson(n,{image:e})}))}remove(e){return r(this,void 0,void 0,(function*(){if(!e)throw t.errors.argumentNull("id");let n=this.url("remove");return this.postByJson(n,{id:e})}))}}t.ImageService=l;let u={text:(e,t)=>(n,r,i)=>{let a=Math.floor(r/e.length*.6);t=t||{},n.fillStyle=t.bgColor||"whitesmoke",n.fillRect(0,0,r,i),n.font=`Bold ${t.fontSize}px Arial`,n.textAlign="left",n.fillStyle=t.textColor||"#999";let o=a*e.length,s=Math.floor(.5*(r-o));Math.floor(.3*(i-(t.fontSize||a)));n.fillText(e,s,Math.floor(.6*i))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataSourcePagingBar=t.PagingBar=t.PagerPosition=void 0;const r=n(26);!function(e){e[e.Bottom=0]="Bottom",e[e.Top=1]="Top",e[e.TopAndBottom=2]="TopAndBottom"}(t.PagerPosition||(t.PagerPosition={}));class i{init(e){this._pageIndex=0;var t=this;t.totalRowCount=1e6,e&&(e.selected.add(e=>{this._selectArguments=e.selectArguments,t.pageSize=e.selectArguments.maximumRows||0;var n=e.selectResult.totalRowCount;null!=n&&n>=0&&(t.totalRowCount=n);var r=this._selectArguments.startRowIndex;(null==r||r<=0)&&(r=0),t.pageIndex=Math.floor(r/t.pageSize),t.render()}),e.deleted.add((function(){t.totalRowCount=t.totalRowCount-1,t.render()})),e.inserted.add((function(){t.totalRowCount=t.totalRowCount+1,t.render()})))}get selectArguments(){return console.assert(null!=this._selectArguments),this._selectArguments}get pageCount(){return Math.ceil(this.totalRowCount/this.pageSize)}get pageSize(){return this._pageSize}set pageSize(e){this._pageSize=e}get pageIndex(){return this._pageIndex}set pageIndex(e){this._pageIndex=e}get totalRowCount(){return this._totalRowCount}set totalRowCount(e){this._totalRowCount=e}render(){throw r.errors.notImplemented("The table-row render method is not implemented.")}}t.PagingBar=i;class a extends i{constructor(e){if(!e.dataSource)throw r.errors.argumentNull("dataSource");if(!e.element)throw r.errors.argumentNull("element");let t=Object.assign(a.defaultPagerSettings,e.pagerSettings||{});super(),this.dataSource=e.dataSource,this.pagerSettings=t,this.element=e.element,this.numberButtons=new Array,this.createButton=this.createPagingButton,this.createLabel=this.createTotalLabel;let n=t.buttonContainerWraper?document.createElement(t.buttonContainerWraper):document.createElement("div");n.className=t.buttonContainerClassName||"buttons",this.element.appendChild(n),this.createPreviousButtons(n),this.createNumberButtons(n),this.createNextButtons(n),this.pagerSettings.showTotal&&(this.totalElement=this.createLabel(),this.totalElement.visible=!1),this.init(e.dataSource)}createPagingButton(e){var t=this.pagerSettings;let n=document.createElement("a");if(n.href="javascript:",this.pagerSettings.buttonWrapper){let t=document.createElement(this.pagerSettings.buttonWrapper);t.appendChild(n),e.appendChild(t)}else e.appendChild(n);let r={_button:n,get visible(){return"none"!=this._button.style.display},set visible(e){let n=this._button,r=t.buttonWrapper?n.parentElement:n;null!=r&&(e?r.style.removeProperty("display"):r.style.display="none")},get pageIndex(){let e=this._button;return new Number(e.getAttribute("pageIndex")).valueOf()},set pageIndex(e){this._button.setAttribute("pageIndex",e)},get text(){return this._button.innerHTML},set text(e){this._button.innerHTML=e},get active(){return null!=this._button.href},set active(e){let n=this._button;if(1==e)return n.removeAttribute("href"),void(t.activeButtonClassName&&this.setClassName(t.activeButtonClassName));n.href="javascript:",t.buttonClassName?this.setClassName(t.buttonClassName):this.setClassName(null)},setClassName(e){let n=this._button,r=t.buttonWrapper?n.parentElement:n;null!=r&&(e?r.className=e:r.removeAttribute("class"))},onclick:null};return n.onclick=()=>{r.onclick&&r.onclick(r,this)},r}createTotalLabel(){let e=document.createElement("div");e.className="total";let t=document.createElement("span");t.className="text",t.innerHTML="总记录：",e.appendChild(t);let n=document.createElement("span");return n.className="number",e.appendChild(n),this.element.appendChild(e),{get text(){return n.innerHTML},set text(e){n.innerHTML=e},get visible(){return"none"!=e.style.display},set visible(t){e.style.display=1==t?"block":"node"}}}createPreviousButtons(e){this.firstPageButton=this.createButton(e),this.firstPageButton.onclick=a.on_buttonClick,this.firstPageButton.text=this.pagerSettings.firstPageText,this.firstPageButton.visible=!1,this.previousPageButton=this.createButton(e),this.previousPageButton.onclick=a.on_buttonClick,this.previousPageButton.text=this.pagerSettings.previousPageText,this.previousPageButton.visible=!1}createNextButtons(e){this.nextPageButton=this.createButton(e),this.nextPageButton.onclick=a.on_buttonClick,this.nextPageButton.text=this.pagerSettings.nextPageText,this.nextPageButton.visible=!1,this.lastPageButton=this.createButton(e),this.lastPageButton.onclick=a.on_buttonClick,this.lastPageButton.text=this.pagerSettings.lastPageText,this.lastPageButton.visible=!1}createNumberButtons(e){let t=this,n=this.pagerSettings.pageButtonCount;for(let t=0;t<n;t++){let n=this.createButton(e);n.onclick=a.on_buttonClick,this.numberButtons[t]=n}this.numberButtons.forEach(e=>{e.onclick=()=>a.on_buttonClick(e,t)})}static on_buttonClick(e,t){let n=e.pageIndex;if(null==!n)return;let r=t.selectArguments;r.maximumRows=t.pageSize,r.startRowIndex=n*t.pageSize,t.pageIndex=n,t.dataSource.select(t.selectArguments)}render(){var e=this.pagerSettings.pageButtonCount;let t=Math.floor(this.pageIndex/e),n=Math.ceil(this.pageCount/e);this.previousPageButton.pageIndex=(t-1)*e,this.nextPageButton.pageIndex=(t+1)*e,this.firstPageButton.pageIndex=0,this.lastPageButton.pageIndex=this.pageCount-1;for(let n=0;n<this.numberButtons.length;n++){let r=t*e+n;r<this.pageCount?(this.numberButtons[n].pageIndex=r,this.numberButtons[n].text=(t*e+n+1).toString(),this.numberButtons[n].visible=!0,this.numberButtons[n].active=r==this.pageIndex):this.numberButtons[n].visible=!1}this.totalElement&&(this.totalElement.text=this.totalRowCount,this.totalElement.visible=!0),this.firstPageButton.visible=!1,this.previousPageButton.visible=!1,this.lastPageButton.visible=!1,this.nextPageButton.visible=!1,t>0&&(this.firstPageButton.visible=!0,this.previousPageButton.visible=!0),t<n-1&&(this.lastPageButton.visible=!0,this.nextPageButton.visible=!0)}}t.DataSourcePagingBar=a,a.defaultPagerSettings={pageButtonCount:10,firstPageText:"<<",lastPageText:">>",nextPageText:"...",previousPageText:"...",showTotal:!0}},function(e,t,n){"use strict";var r,i=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},a=this&&this.__classPrivateFieldSet||function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n};Object.defineProperty(t,"__esModule",{value:!0}),t.ModalDialog=void 0;const o=n(4),s=n(3);class l extends s.Component{constructor(){super(...arguments),r.set(this,void 0)}get element(){return i(this,r)}show(){o.showDialog(i(this,r))}hide(){o.hideDialog(i(this,r))}render(){return s.createElement("div",{className:"modal fade "+(this.props.className||""),ref:e=>a(this,r,e||i(this,r))},s.createElement("div",{className:"modal-dialog "+(this.props.isLarge?"modal-lg":"")},s.createElement("div",{className:"modal-content"},this.header(),this.body(),this.footer())))}findChild(e){return this.findChildren(e)[0]}findChildren(e){if(null==this.props.children)return[];return(Array.isArray(this.props.children)?this.props.children:[this.props.children]).filter(e)}footer(){let e=this.findChild(e=>{var t;return"modal-footer"==(null===(t=e.props)||void 0===t?void 0:t.className)});return null==e&&(e=s.createElement("div",{className:"modal-footer",style:{marginTop:0}},s.createElement("button",{type:"button",className:"btn btn-default","data-dismiss":"modal"},this.props.cancelButtonText||"取消"),s.createElement("button",{type:"button",className:"btn btn-primary",onClick:()=>this.props.onConfirm?this.props.onConfirm():null},this.props.confirmButtonText||"确定"))),e}header(){let e=this.findChild(e=>{var t;return"modal-header"==(null===(t=e.props)||void 0===t?void 0:t.className)});return null==e&&(e=s.createElement("div",{className:"modal-header"},s.createElement("button",{type:"button",className:"btn close","data-dismiss":"modal"},s.createElement("span",{"aria-hidden":"true"},"×"),s.createElement("span",{className:"sr-only"},"Close")),s.createElement("h4",{className:"modal-title"},this.props.title||""))),e}body(){let e=this.findChild(e=>{var t;return"div"==e.type&&"modal-body"==(null===(t=e.props)||void 0===t?void 0:t.className)});if(null==e){let t=["modal-header","modal-body","modal-footer"],n=this.findChildren(e=>{var n;return t.indexOf(null===(n=e.props)||void 0===n?void 0:n.className)<0});e=s.createElement("div",{className:"modal-body"},n)}return e}}t.ModalDialog=l,r=new WeakMap},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataSourceDialogContext=t.DataSourceDialog=t.ModalDialog=t.ImageService=t.showImageDialog=t.ImageUpload=t.ImageThumber=void 0;var r=n(11);Object.defineProperty(t,"ImageThumber",{enumerable:!0,get:function(){return r.default}});var i=n(12);Object.defineProperty(t,"ImageUpload",{enumerable:!0,get:function(){return i.default}});var a=n(20);Object.defineProperty(t,"showImageDialog",{enumerable:!0,get:function(){return a.showImageDialog}});var o=n(14);Object.defineProperty(t,"ImageService",{enumerable:!0,get:function(){return o.ImageService}});var s=n(16);Object.defineProperty(t,"ModalDialog",{enumerable:!0,get:function(){return s.ModalDialog}});var l=n(27);Object.defineProperty(t,"DataSourceDialog",{enumerable:!0,get:function(){return l.DataSourceDialog}}),Object.defineProperty(t,"DataSourceDialogContext",{enumerable:!0,get:function(){return l.DataSourceDialogContext}})},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(7),o={insert:"head",singleton:!1};i()(a.a,o);t.default=a.a.locals||{}},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(8),o={insert:"head",singleton:!1};i()(a.a,o);t.default=a.a.locals||{}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.showImageDialog=void 0;const i=n(12),a=n(11),o=n(3),s=n(13),l=n(21),u=n(4),c=n(14),d=n(5),m=n(6);n(25);const p=n(15);let h=d.getStrings();class g extends o.Component{constructor(e){super(e),this.state={images:[],selectedItems:[]},this.selectArguments={maximumRows:17},this.dataSource=function(){let e=new c.ImageService;return new m.DataSource({primaryKeys:["id"],select(t){return r(this,void 0,void 0,(function*(){return yield e.list(t)}))},delete(t){return r(this,void 0,void 0,(function*(){return yield e.remove(t.id)}))},insert(t){return r(this,void 0,void 0,(function*(){console.assert(null!=t.data);let n=yield e.upload(t.data);return Object.assign(t,n),n}))}})}(),this.dataSource.selected.add(e=>{this.setState({images:e.selectResult.dataItems})}),this.dataSource.inserted.add(e=>{this.state.images.push(e.dataItem),this.setState({images:this.state.images})}),this.imageService=new c.ImageService}componentDidMount(){return r(this,void 0,void 0,(function*(){new p.DataSourcePagingBar({dataSource:this.dataSource,element:this.pagingBarElement,pagerSettings:{activeButtonClassName:"active",buttonWrapper:"li",buttonContainerWraper:"ul",showTotal:!1}});let e=this.pagingBarElement.querySelector("ul");e&&(e.className="pagination")}))}show(e,t){this.showDialogCallback=t,this.selectArguments.startRowIndex=0,this.dataSource.select(this.selectArguments),this.setState({selectedItems:[],selectedMax:e}),u.showDialog(this.props.element)}saveImage(e){return r(this,void 0,void 0,(function*(){this.dataSource.insert({data:e})}))}removeImage(e){this.dataSource.delete(e);let t=this.state.images;t=t.filter(t=>t.id!=e.id),this.setState({images:t})}render(){let{images:e,selectedItems:t,selectedMax:n}=this.state,r=this.props.element;return o.createElement("div",{className:"modal-dialog modal-lg"},o.createElement("div",{className:"modal-content"},o.createElement("div",{className:"modal-header"},o.createElement("button",{type:"button",className:"btn close",onClick:()=>u.hideDialog(r)},o.createElement("span",{"aria-hidden":"true"},"×")),o.createElement("h4",{className:"modal-title"},h.selectImage)),o.createElement("div",{className:"modal-body"},e.map(e=>{let r=t.indexOf(e.id)>=0?""+(t.indexOf(e.id)+1):"",i=t.length==n;return o.createElement(a.default,{key:e.id,imagePath:this.imageService.imageSource(e.id,150,150),remove:()=>this.removeImage(e),selectedText:r,disabled:i&&!r,text:null!=e.width&&null!=e.height?`${e.width} X ${e.height}`:" ",onClick:()=>{let t=this.state.selectedItems;if(t.indexOf(e.id)>=0)t=t.filter(t=>t!=e.id);else{if(t.length==n)return;t.push(e.id)}this.setState({selectedItems:t})}})}),o.createElement(i.default,{saveImage:e=>this.saveImage(e.base64),width:400}),o.createElement("div",{className:"clearfix"})),o.createElement("div",{className:"modal-footer"},o.createElement("div",{className:"pull-left",ref:e=>this.pagingBarElement=e||this.pagingBarElement}),n?o.createElement("div",{className:"pull-left",style:{paddingTop:8,paddingLeft:10}},h.selectMax,o.createElement("b",{style:{padding:"0 2px 0 2px"}},n),"张"):null,o.createElement("button",{name:"cancel",type:"button",className:"btn btn-default",onClick:()=>u.hideDialog(r)},h.cancel),o.createElement("button",{name:"ok",type:"button",className:"btn btn-primary",disabled:0==t.length,onClick:()=>{if(this.showDialogCallback){let e=this.state.selectedItems.map(e=>e);this.showDialogCallback(e)}u.hideDialog(r)}},h.confirm))))}}let f=l.createDialogElement("image-manager"),A=s.render(o.createElement(g,{element:f}),f);t.default={show(e){A.show(void 0,e)}},t.showImageDialog=function(e,t){"function"==typeof e&&(t=e=null),A.show(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDialogElement=t.imageUrl=void 0,t.imageUrl=function(e,t,n){if(!e)return e;if(e.startsWith("data:image"))return e;if(e.indexOf(",")>0&&(e=e.split(",")[0]),e.startsWith("http://")){let t=(e=e.substr("http://".length)).indexOf("/");console.assert(t>0),e=e.substr(t)}else"/"==e[0]&&(e=e.substr(1));let r=new Array,i=(location.protocol,""+e);return t&&(r.push({name:"width",value:t.toString()}),n&&r.push({name:"height",value:n.toString()})),navigator.userAgent.indexOf("chrome")<0&&r.push({name:"type",value:"jpeg"}),r.length>0&&(i=i+"?"+r.map(e=>`${e.name}=${e.value}`).join("&")),i},t.createDialogElement=function(e){let t=document.createElement("div");return t.className="modal fade "+e,t.style.zIndex="1000",document.body.appendChild(t),t}},function(module,exports,__webpack_require__){(function(global){
/*!
 * ~
 *  maishu-chitu-service v1.32.0
 *  
 *  Copyright (c) 2016-2018, shu mai <ansiboy@163.com>
 *  Licensed under the MIT License.
 * 
 */
var factory;"undefined"==typeof window||window,factory=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./out/index.js")}({"./out/callback.js":
/*!*************************!*\
  !*** ./out/callback.js ***!
  \*************************/
/*! exports provided: Callback, Callbacks */function(e,t,n){"use strict";n.r(t),n.d(t,"Callback",(function(){return r})),n.d(t,"Callbacks",(function(){return i}));class r{constructor(){this.funcs=new Array}add(e){this.funcs.push(e)}remove(e){this.funcs=this.funcs.filter(t=>t!=e)}fire(...e){this.funcs.forEach(t=>t(...e))}}function i(){return new r}},"./out/errors.js":
/*!***********************!*\
  !*** ./out/errors.js ***!
  \***********************/
/*! exports provided: Errors, errors */function(e,t,n){"use strict";n.r(t),n.d(t,"Errors",(function(){return r})),n.d(t,"errors",(function(){return i}));class r{unexpectedNullValue(e){return new Error(`variable ${e} is unexpected null value.`)}parseJSONFail(e){return new Error("Parse json string fail:\r\n"+e)}}let i=new r},"./out/index.js":
/*!**********************!*\
  !*** ./out/index.js ***!
  \**********************/
/*! exports provided: Service, formatData, Callback, Callbacks, ValueStore, LocalValueStore, CookieValueStore, StatusCodes, StatusCode */function(e,t,n){"use strict";n.r(t);var r=n(/*! ./service */"./out/service.js");n.d(t,"Service",(function(){return r.Service})),n.d(t,"formatData",(function(){return r.formatData}));var i=n(/*! ./callback */"./out/callback.js");n.d(t,"Callback",(function(){return i.Callback})),n.d(t,"Callbacks",(function(){return i.Callbacks}));var a=n(/*! ./value-store */"./out/value-store.js");n.d(t,"ValueStore",(function(){return a.ValueStore})),n.d(t,"LocalValueStore",(function(){return a.LocalValueStore})),n.d(t,"CookieValueStore",(function(){return a.CookieValueStore}));var o=n(/*! ./status-code */"./out/status-code.js");n.d(t,"StatusCodes",(function(){return o.StatusCode})),n.d(t,"StatusCode",(function(){return o.StatusCode}))},"./out/service.js":
/*!************************!*\
  !*** ./out/service.js ***!
  \************************/
/*! exports provided: Service, formatData */function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Service",(function(){return Service})),__webpack_require__.d(__webpack_exports__,"formatData",(function(){return formatData}));var _callback__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(/*! ./callback */"./out/callback.js"),_errors__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(/*! ./errors */"./out/errors.js"),__awaiter=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))};class Service{constructor(e){this.error=Object(_callback__WEBPACK_IMPORTED_MODULE_0__.Callbacks)(),this.headers={},e&&this.error.add((t,n)=>{e(n,this)})}ajax(e,t){void 0===t&&(t={});let n,r=t.data,i=t.method,a=Object.assign({},Service.headers,this.headers,t.headers||{});if(null!=r)if((a["content-type"]||"").indexOf("json")>=0)n=JSON.stringify(r);else{n=new URLSearchParams;for(let e in r)n.append(e,r[e])}return new Promise((t,r)=>{let o,s={headers:a,body:n,method:i};if(null==s)throw _errors__WEBPACK_IMPORTED_MODULE_1__.errors.unexpectedNullValue("options");"get"==i&&(o=setTimeout(()=>{console.warn("timeout url: "+e);let t=new Error;t.name="timeout",t.message="网络连接超时",r(t),this.error.fire(this,t),clearTimeout(o)},1e3*Service.settings.ajaxTimeout)),ajax(e,s).then(e=>{t(e),o&&clearTimeout(o)}).catch(e=>{r(e),this.error.fire(this,e),o&&clearTimeout(o)})})}createService(e){let t=new(e=e||Service);return t.error.add((e,n)=>{this.error.fire(t,n)}),t}getByJson(e,t,n){return t&&Object.getOwnPropertyNames(t).length>0&&(e=`${e}?${encodeURIComponent(JSON.stringify(t))}`),(n=n||{})["content-type"]="application/json",this.ajax(e,{headers:n,method:"get"})}putByJson(e,t,n){return(n=n||{})["content-type"]="application/json",this.ajax(e,{headers:n,data:t,method:"put"})}postByJson(e,t,n){return(n=n||{})["content-type"]="application/json",this.ajax(e,{headers:n,data:t,method:"post"})}deleteByJson(e,t,n){return(n=n||{})["content-type"]="application/json",this.ajax(e,{headers:n,data:t,method:"delete"})}isEncoded(e){try{return(e=e||"")!==decodeURIComponent(e)}catch(e){return!1}}get(e,t,n){t=t||{};let r="";for(let e in t){if(null==t[e])continue;let n=""+t[e];this.isEncoded(n)||(n=encodeURIComponent(n)),r=r?`${r}&${e}=${n}`:`${e}=${n}`}return r&&(e=`${e}?${r}`),this.ajax(e,{headers:n,method:"get"})}put(e,t,n){return(n=n||{})["content-type"]="application/x-www-form-urlencoded",this.ajax(e,{headers:n,data:t,method:"put"})}post(e,t,n){return(n=n||{})["content-type"]="application/x-www-form-urlencoded",this.ajax(e,{headers:n,data:t,method:"post"})}delete(e,t,n){return(n=n||{})["content-type"]="application/x-www-form-urlencoded",this.ajax(e,{headers:n,data:t,method:"delete"})}}function formatData(e){if("object"==typeof e){for(let t in e)e[t]=formatData(e[t]);return e}return"string"==typeof e&&/\d{4}-\d{1,2}-\d{1,2}T\d{1,2}:\d{1,2}:\d{1,2}/.test(e)?new Date(e):e}function ajax(url,options){return __awaiter(this,void 0,void 0,(function*(){let response;response="undefined"==typeof window?yield eval("require")("node-fetch")(url,options):yield fetch(url,options);let responseText=response.text(),p;p="string"==typeof responseText?new Promise((e,t)=>{e(responseText)}):responseText;let text=yield responseText,textObject,isJSONContextType=(response.headers.get("content-type")||"").indexOf("json")>=0;if(isJSONContextType)try{textObject=text?JSON.parse(text):{}}catch(e){let t=_errors__WEBPACK_IMPORTED_MODULE_1__.errors.parseJSONFail(text);console.error(t),textObject=text}else textObject=text;if(response.status>=300){let e=new Error;throw e.method=options.method,e.name=""+response.status,e.message="string"==typeof textObject?textObject:textObject.Message||textObject.message||"",e.message=e.message||response.statusText,e}return textObject=formatData(textObject),textObject}))}Service.settings={ajaxTimeout:30},Service.headers={}},"./out/status-code.js":
/*!****************************!*\
  !*** ./out/status-code.js ***!
  \****************************/
/*! exports provided: StatusCode */function(e,t,n){"use strict";var r;n.r(t),n.d(t,"StatusCode",(function(){return r})),function(e){e[e.Login=282]="Login",e[e.Logout=283]="Logout",e[e.NotFound=404]="NotFound",e[e.OK=200]="OK",e[e.Redirect=301]="Redirect",e[e.BadRequest=400]="BadRequest",e[e.Forbidden=403]="Forbidden",e[e.CustomError=700]="CustomError",e[e.ArgumentNull=705]="ArgumentNull",e[e.FieldNull=709]="FieldNull",e[e.ArgumentTypeIncorrect=710]="ArgumentTypeIncorrect",e[e.UserNotLogin=718]="UserNotLogin",e[e.NoPermission=726]="NoPermission",e[e.UserIdNull=727]="UserIdNull",e[e.ObjectNotExistWithId=728]="ObjectNotExistWithId"}(r||(r={}))},"./out/value-store.js":
/*!****************************!*\
  !*** ./out/value-store.js ***!
  \****************************/
/*! exports provided: ValueStore, LocalValueStore, CookieValueStore */function(e,t,n){"use strict";n.r(t),n.d(t,"ValueStore",(function(){return r})),n.d(t,"LocalValueStore",(function(){return i})),n.d(t,"CookieValueStore",(function(){return a}));class r{constructor(e){this.items=new Array,this._value=e}attach(e,t){return void 0!==this.value&&e(this.value,t),this.add(e,t)}add(e,t){return this.items.push({func:e,sender:t}),e}remove(e){this.items=this.items.filter(t=>t.func!=e)}fire(e){this.items.forEach(t=>t.func(e,t.sender))}get value(){return void 0===this._value?null:this._value}set value(e){this._value=e,this.fire(e)}}class i extends r{constructor(e){super(i.loadValue(e)),this.storageName=e}get value(){return super.value}set value(e){super.value=e,i.saveValue(this.storageName,e)}static loadValue(e){let t=localStorage.getItem(e);return null==t?null:JSON.parse(t)}static saveValue(e,t){null!=t?localStorage.setItem(e,JSON.stringify(t)):localStorage.removeItem(e)}}class a extends r{constructor(e){super(a.loadValue(e)),this.storageName=e}get value(){return super.value}set value(e){super.value=e,a.saveValue(this.storageName,e)}static loadValue(e){let t=a.getCookie(e);return null==t?null:JSON.parse(t)}static saveValue(e,t){null!=t?a.setCookie(e,JSON.stringify(t)):a.removeCookie(e)}static setCookie(e,t,n){if("undefined"!=typeof document){var r="";if(n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3),r="; expires="+i.toUTCString()}document.cookie=e+"="+(t||"")+r+"; path=/"}}static getCookie(e){if("undefined"==typeof document)return null;for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return null}static removeCookie(e){this.setCookie(e,"")}}}})},module.exports=factory()}).call(this,__webpack_require__(23))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorHandle=void 0,t.errorHandle=function(e){if("undefined"==typeof window)throw e;Promise.resolve().then(()=>n(4)).then(t=>{t.alert({title:"错误",message:e.message})})}},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(9),o={insert:"head",singleton:!1};i()(a.a,o);t.default=a.a.locals||{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errors=void 0;const r=n(6);class i extends r.Errors{serviceHostNotConfig(){return new Error("Service host is not config.")}notImplemented(e){return e=e||"Not implemented",new Error(e)}}t.errors=new i},function(e,t,n){"use strict";var r,i,a=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},o=this&&this.__classPrivateFieldSet||function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n};Object.defineProperty(t,"__esModule",{value:!0}),t.DataSourceDialog=t.DataSourceDialogContext=void 0;const s=n(3),l=n(15),u=n(5),c=n(16);n(28);let d=u.getStrings();t.DataSourceDialogContext=s.createContext({dataItem:null});class m extends s.Component{constructor(e){super(e),r.set(this,void 0),i.set(this,void 0),this.state={},this.props.dataSource.selecting.add(e=>{this.setState({items:void 0})}),this.props.dataSource.selected.add(e=>{this.setState({items:e.selectResult.dataItems})}),this.props.dataSource.inserted.add(e=>{var t;null===(t=this.state.items)||void 0===t||t.push(e.dataItem),this.setState({items:this.state.items})})}show(){this.props.dataSource.select({maximumRows:this.props.pageItemsCount}),a(this,i).show()}confirm(){}pagingBarRef(e){if(!e||a(this,r))return;o(this,r,new l.DataSourcePagingBar({dataSource:this.props.dataSource,element:e,pagerSettings:{activeButtonClassName:"active",buttonWrapper:"li",buttonContainerWraper:"ul",showTotal:!1}}));let t=e.querySelector("ul");t&&(t.className="pagination")}renderBody(){let{items:e}=this.state;return void 0===e?s.createElement("div",{className:"empty"},d.dataLoading):null==e||0==e.length?s.createElement("div",{className:"empty"},d.dataEmpty):e.map((e,n)=>s.createElement(t.DataSourceDialogContext.Provider,{key:n,value:{dataItem:e}},this.props.children))}componentDidMount(){}render(){return s.createElement(c.ModalDialog,Object.assign({},this.props,{className:"data-source-dialog",ref:e=>o(this,i,e||a(this,i))}),s.createElement("div",{className:"modal-body"},this.renderBody()),s.createElement("div",{className:"modal-footer",style:{marginTop:0},ref:e=>this.pagingBarRef(e)},s.createElement("button",{type:"button",className:"btn btn-default","data-dismiss":"modal"},this.props.cancelButtonText||"取消"),s.createElement("button",{type:"button",className:"btn btn-primary",onClick:()=>this.confirm()},this.props.confirmButtonText||"确定")))}}t.DataSourceDialog=m,r=new WeakMap,i=new WeakMap},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(10),o={insert:"head",singleton:!1};i()(a.a,o);t.default=a.a.locals||{}}])}));
//# sourceMappingURL=index.min.js.map